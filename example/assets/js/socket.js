// Generated by CoffeeScript 1.6.2
(function() {
  var clickHandler, connectBtnClick, connection, connectionUri, disconnectBtnClick, doSend, init, onClose, onError, onMessage, onOpen, output, submitAuthBtnClick, testWebSocket, writeToScreen;

  connection = null;

  connectionUri = "ws://localhost:4568";

  output = null;

  init = function() {
    output = document.getElementById("main");
    return testWebSocket();
  };

  testWebSocket = function() {
    connection = new WebSocket(connectionUri);
    connection.onopen = function(evt) {
      return onOpen(evt);
    };
    connection.onclose = function(evt) {
      return onClose(evt);
    };
    connection.onmessage = function(evt) {
      return onMessage(evt);
    };
    return connection.onerror = function(evt) {
      return onError(evt);
    };
  };

  onOpen = function(evt) {
    writeToScreen("Connected.");
    return doSend("WebSockets Rocks");
  };

  onClose = function(evt) {
    return writeToScreen("Disconnected");
  };

  onMessage = function(evt) {
    return writeToScreen('<span style="color: blue;">RESPONSE: ' + evt.data + '</span>');
  };

  onError = function(evt) {
    return writeToScreen('<span style="color: red;">ERROR:' + evt.data + '</span>');
  };

  doSend = function(message) {
    writeToScreen("SENT: " + message);
    return connection.send(message);
  };

  writeToScreen = function(message) {
    var pre;

    pre = document.createElement("p");
    pre.style.wordWrap = "break-word";
    pre.innerHTML = message;
    return output.appendChild(pre);
  };

  clickHandler = function(evt) {
    if (evt.target.id === "connect-btn") {
      return connectBtnClick(evt);
    } else if (evt.target.id === "disconnect-btn") {
      return disconnectBtnClick(evt);
    } else if (evt.target.id === "submit-auth-btn") {
      return submitAuthBtnClick(evt);
    }
  };

  connectBtnClick = function(evt) {
    output = document.getElementById('main');
    connection = new WebSocket(connectionUri);
    connection.onopen = function(evt) {
      return onOpen(evt);
    };
    connection.onclose = function(evt) {
      return onClose(evt);
    };
    connection.onmessage = function(evt) {
      return onMessage(evt);
    };
    return connection.onerror = function(evt) {
      return onError(evt);
    };
  };

  disconnectBtnClick = function(evt) {
    return connection.close();
  };

  submitAuthBtnClick = function(evt) {
    var inputBox;

    inputBox = document.getElementById("command-input");
    return doSend(inputBox.value);
  };

  window.addEventListener("click", clickHandler, false);

}).call(this);
